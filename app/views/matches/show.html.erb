<h1 class="text-center mb-5 fw-bold">Detalles del Partido</h1>

<%= render "matches/show/summary", match: @match %>
<%= render "matches/show/mvp", match: @match %>
<%= render "matches/show/pre_visualization", match: @match %>
<%= render "matches/show/vs_fight", match: @match, featured_by_team: @featured_by_team %>
<%= render "matches/show/team_players", match: @match, teams: @teams, participations: @participations %>
<% if user_signed_in? %>
  <%= render "matches/show/add_participation_button" %>
<% end %>
<%= render "matches/show/video", match: @match %>

<!--MODALS-->
<%= render "modals/add_participation", match: @match, available_players: @available_players %>
<%= render "modals/add_participations", match: @match, available_players: @available_players %>
<%= render "modals/add_result", match: @match %>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
    });
    document.addEventListener("DOMContentLoaded", function() {
      const toggleBtn = document.getElementById("toggle-preview");
      const previewSection = document.getElementById("preview-section");

      if (toggleBtn && previewSection) {
      toggleBtn.addEventListener("click", function() {
      if (previewSection.style.display === "none") {
      previewSection.style.display = "";
      toggleBtn.textContent = "Ocultar previsualización";
  } else {
      previewSection.style.display = "none";
      toggleBtn.textContent = "Mostrar previsualización";
  }
  });
  }
  });

    (function() {
        function bindMultiModalOpen() {
            const btn   = document.getElementById('open-multi-participations');
            const modal = document.getElementById('addParticipationsModal');
            if (!btn || !modal || !window.bootstrap) return;

            // Evita múltiples listeners si Turbo vuelve a cargar la vista
            btn.dataset.bound = btn.dataset.bound || "0";
            if (btn.dataset.bound === "1") return;
            btn.dataset.bound = "1";

            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const instance = bootstrap.Modal.getOrCreateInstance(modal);
                instance.show();
            });
        }

        document.addEventListener('DOMContentLoaded', bindMultiModalOpen);
        document.addEventListener('turbo:load', bindMultiModalOpen);
    })();
</script>


